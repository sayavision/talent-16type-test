<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ‰èƒ½8è»¸è¨ºæ–­ï¼‹æ˜Ÿã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ16ã‚¿ã‚¤ãƒ—ï¼ˆãƒ™ãƒ¼ã‚¿ï¼‰</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      max-width: 900px;
      margin: 0 auto;
      padding: 16px;
      line-height: 1.7;
      background: #f7f7fb;
    }
    h1 {
      font-size: 1.4rem;
      margin-bottom: 0.5rem;
    }
    .card {
      background: #fff;
      border-radius: 12px;
      padding: 16px 18px;
      margin: 12px 0;
      box-shadow: 0 4px 12px rgba(0,0,0,0.04);
    }
    .question {
      margin-bottom: 16px;
      padding-bottom: 12px;
      border-bottom: 1px solid #eee;
    }
    .question:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }
    /* â˜…æœªå›ç­”ã®ã¨ãèµ¤ããƒã‚¤ãƒ©ã‚¤ãƒˆ */
    .question.unanswered {
      border: 1px solid #f97373;
      background: #fef2f2;
      border-radius: 8px;
      padding: 12px 12px 8px 12px;
    }
    .question-title {
      font-weight: 600;
      margin-bottom: 6px;
    }
    .options {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      font-size: 0.9rem;
    }
    label.option {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid #ddd;
      cursor: pointer;
      background: #fafafa;
    }
    input[type="radio"] {
      cursor: pointer;
    }
    button {
      border: none;
      border-radius: 999px;
      padding: 10px 18px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      background: #4b7bec;
      color: white;
      margin-top: 8px;
    }
    button:disabled {
      opacity: 0.6;
      cursor: default;
    }
    .small {
      font-size: 0.85rem;
      color: #666;
    }
    .result-title {
      font-weight: 600;
      margin-bottom: 4px;
    }
    .axis-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin: 6px 0;
      font-size: 0.95rem;
    }
    .axis-label {
      min-width: 190px;
    }
    .axis-bar-wrap {
      flex: 1;
      background: #f0f0f5;
      border-radius: 999px;
      overflow: hidden;
      height: 10px;
    }
    .axis-bar {
      height: 100%;
      width: 0%;
      transition: width 0.4s;
    }
    .axis-percent {
      min-width: 40px;
      text-align: right;
      font-variant-numeric: tabular-nums;
    }
    .badge {
      display: inline-block;
      font-size: 0.75rem;
      padding: 2px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: #3730a3;
      margin-left: 4px;
    }
    input[type="date"] {
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid #ccc;
      font-size: 0.9rem;
      margin-left: 4px;
    }
  </style>
</head>
<body>

  <!-- ã‚¿ã‚¤ãƒˆãƒ« -->
  <div class="card">
    <h1>æ‰èƒ½8è»¸è¨ºæ–­ï¼‹æ˜Ÿã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ16ã‚¿ã‚¤ãƒ—ï¼ˆãƒ™ãƒ¼ã‚¿ï¼‰</h1>
    <p class="small">
      ã‚ãªãŸã®ä¸­ã«ã‚ã‚‹<strong>4ã¤ã®ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ</strong>ã‚’è¨ºæ–­ã—ã€ã•ã‚‰ã«ãã‚Œãã‚Œã‚’2ã¤ã®è»¸ã«åˆ†ã‘ã¦åˆè¨ˆ8è»¸ã¨ã—ã¦è¦‹ã¦ã„ãã¾ã™ã€‚<br><br>
      EARTHï¼ˆåœŸï¼‰ï¼šå¤§åœ°ã®ãƒ‡ã‚¶ã‚¤ãƒ³è»¸ï¼å¤§åœ°ã®å®Ÿè¡Œè»¸<br>
      FIREï¼ˆç«ï¼‰ï¼šç«ã®ç™ºä¿¡è»¸ï¼ç«ã®æ¨é€²è»¸<br>
      AIRï¼ˆé¢¨ï¼‰ï¼šé¢¨ã®åˆ†æè»¸ï¼é¢¨ã®æ¢ç©¶è»¸<br>
      WATERï¼ˆæ°´ï¼‰ï¼šæ°´ã®å…±æ„Ÿè»¸ï¼æ°´ã®ãƒãƒ¼ãƒ è»¸<br><br>
      å…¨éƒ¨ã§<strong>48å•ï¼ˆå„è»¸6å•Ã—8è»¸ï¼‰</strong>ã‚ã‚Šã¾ã™ã€‚ç›´æ„Ÿã§ã€Œ1ã€œ5ã€ã®ä¸­ã‹ã‚‰ã€ã„ã¡ã°ã‚“è¿‘ã„æ•°å­—ã‚’é¸ã‚“ã§ãã ã•ã„ã€‚
    </p>
    <p class="small">
      1ï¼šã¾ã£ãŸãå½“ã¦ã¯ã¾ã‚‰ãªã„ï¼2ï¼šã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„ï¼3ï¼šã©ã¡ã‚‰ã¨ã‚‚ã„ãˆãªã„ï¼4ï¼šã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹ï¼5ï¼šã¨ã¦ã‚‚å½“ã¦ã¯ã¾ã‚‹
    </p>
  </div>

  <!-- ç”Ÿå¹´æœˆæ—¥å…¥åŠ› -->
  <div class="card">
    <div class="result-title">ç”Ÿå¹´æœˆæ—¥ã®å…¥åŠ›ï¼ˆä»»æ„ï¼‰</div>
    <p class="small">
      æ˜Ÿã¨ã®ã‹ã‘åˆã‚ã›è¨ºæ–­ã®ãŸã‚ã«ã€ç”Ÿå¹´æœˆæ—¥ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚<br>
      ã“ã“ã‹ã‚‰ã‚ãªãŸã®<strong>12æ˜Ÿåº§</strong>ã¨<strong>æ˜Ÿã®ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ</strong>ã‚’èª­ã¿å–ã‚Šã¾ã™ã€‚
    </p>
    <p class="small">
      ç”Ÿå¹´æœˆæ—¥ï¼š
      <input type="date" id="birthDate">
    </p>
    <p class="small">
      â€»å…¥åŠ›ã—ãªãã¦ã‚‚ã€æ‰èƒ½8è»¸ã®çµæœã¯è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚<br>
      â€»ç”Ÿå¹´æœˆæ—¥ã‚’å…¥ã‚Œã‚‹ã¨ã€Œæ˜ŸÃ—æ‰èƒ½ã€ã®16ã‚¿ã‚¤ãƒ—çµæœã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå‡ºã¾ã™ã€‚
    </p>
  </div>

  <!-- è³ªå•ãƒ•ã‚©ãƒ¼ãƒ  -->
  <form id="quizForm" class="card">
    <div id="questionsContainer"></div>
    <button type="submit">çµæœã‚’è¦‹ã‚‹</button>
    <p class="small">â€»ã™ã¹ã¦ã®è³ªå•ã«å›ç­”ã—ã¦ã‹ã‚‰ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚æœªå›ç­”ã®é …ç›®ã¯èµ¤ãè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
  </form>

  <!-- çµæœè¡¨ç¤º -->
  <div id="resultCard" class="card" style="display:none;">
    <div id="resultContent"></div>

    <!-- çµæœã‚·ã‚§ã‚¢ -->
    <div id="resultShare" style="margin-top:12px;">
      <button type="button" id="copyResultBtn">çµæœãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼</button>
      <button type="button" id="shareResultBtn">çµæœã‚’ã‚·ã‚§ã‚¢</button>
      <p id="shareMessage" class="small"></p>
    </div>

    <hr style="margin:14px 0;">
    <div class="result-title">4ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã®ãƒ¬ãƒ¼ãƒ€ãƒ¼ãƒãƒ£ãƒ¼ãƒˆ</div>
    <p class="small">å…¨ä½“ã®ãƒãƒ©ãƒ³ã‚¹ã‚’æ„Ÿè¦šçš„ã«çœºã‚ã¦ã¿ã¦ãã ã•ã„ã€‚</p>
    <canvas id="domainRadar" style="max-width: 100%;"></canvas>

    <!-- æ˜Ÿã¨æ‰èƒ½ã®ã‚¿ã‚¤ãƒ—è¨ºæ–­ -->
    <hr style="margin:16px 0;">
    <div id="astroSection">
      <div class="result-title">æ˜Ÿã¨æ‰èƒ½ã‚’åˆã‚ã›ãŸ16ã‚¿ã‚¤ãƒ—è¨ºæ–­</div>
      <p class="small">
        ç”Ÿå¹´æœˆæ—¥ã‹ã‚‰<strong>12æ˜Ÿåº§</strong>ã¨<strong>æ˜Ÿã®ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ</strong>ã‚’åˆ¤å®šã—ã€æ‰èƒ½ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã¨ã®ã‹ã‘åˆã‚ã›ã§ã‚¿ã‚¤ãƒ—ã‚’å‡ºã—ã¾ã™ã€‚<br>
        â€»ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã—ã¦ã„ãªã„å ´åˆã€ã€Œæ˜ŸÃ—æ‰èƒ½ã€ã®çµæœã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚
      </p>
      <div id="astroResultBox" class="small" style="margin-top:10px;"></div>
    </div>
  </div>

  <script>
    // ---- 8è»¸å®šç¾© ----
    const axes = {
      // EARTHï¼šå½¢ã«ã™ã‚‹é ˜åŸŸ
      X1: { id: "X1", label: "å¤§åœ°ã®ãƒ‡ã‚¶ã‚¤ãƒ³è»¸", domain: "EARTHï½œå½¢ã«ã™ã‚‹é ˜åŸŸ" },
      X2: { id: "X2", label: "å¤§åœ°ã®å®Ÿè¡Œè»¸",   domain: "EARTHï½œå½¢ã«ã™ã‚‹é ˜åŸŸ" },

      // FIREï¼šäººã¨å ´ã‚’å‹•ã‹ã™é ˜åŸŸ
      I1: { id: "I1", label: "ç«ã®ç™ºä¿¡è»¸",     domain: "FIREï½œäººã¨å ´ã‚’å‹•ã‹ã™é ˜åŸŸ" },
      I2: { id: "I2", label: "ç«ã®æ¨é€²è»¸",     domain: "FIREï½œäººã¨å ´ã‚’å‹•ã‹ã™é ˜åŸŸ" },

      // AIRï¼šã—ãã¿ã‚’çµ„ã‚€é ˜åŸŸ
      T1: { id: "T1", label: "é¢¨ã®åˆ†æè»¸",     domain: "AIRï½œã—ãã¿ã‚’çµ„ã‚€é ˜åŸŸ" },
      T2: { id: "T2", label: "é¢¨ã®æ¢ç©¶è»¸",     domain: "AIRï½œã—ãã¿ã‚’çµ„ã‚€é ˜åŸŸ" },

      // WATERï¼šçµ†ã‚’è‚²ã¦ã‚‹é ˜åŸŸ
      R1: { id: "R1", label: "æ°´ã®å…±æ„Ÿè»¸",     domain: "WATERï½œçµ†ã‚’è‚²ã¦ã‚‹é ˜åŸŸ" },
      R2: { id: "R2", label: "æ°´ã®ãƒãƒ¼ãƒ è»¸",   domain: "WATERï½œçµ†ã‚’è‚²ã¦ã‚‹é ˜åŸŸ" }
    };

    const axisOrder = ["X1","X2","I1","I2","T1","T2","R1","R2"];

    // ---- 4ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆèª¬æ˜ ----
    const domainDescriptions = {
      "EARTHï½œå½¢ã«ã™ã‚‹é ˜åŸŸ":
        "ç¾å®Ÿä¸–ç•Œã§ä¸€æ­©ãšã¤ã€Œå½¢ã«ã—ã¦ã„ãã€ã‚¨ãƒªã‚¢ã€‚è¨ˆç”»ã‚’ç«‹ã¦ã‚‹ãƒ»æ®µå–ã‚Šã™ã‚‹ãƒ»ã‚„ã‚Šåˆ‡ã‚‹ã“ã¨ã§ã€ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ç¾å®Ÿã®çµæœã«ã¤ãªã’ã¦ã„ãé ˜åŸŸã§ã™ã€‚",

      "FIREï½œäººã¨å ´ã‚’å‹•ã‹ã™é ˜åŸŸ":
        "è¨€è‘‰ã‚„å­˜åœ¨æ„Ÿã§ã€äººã¨å ´ã«ç«ã‚’ç¯ã™ã‚¨ãƒªã‚¢ã€‚ç™ºä¿¡ãƒ»èª¬å¾—ãƒ»ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ãªã©ã‚’é€šã—ã¦ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ç”Ÿã¿å‡ºã—ã€å‘¨ã‚Šã‚’å‹•ã‹ã—ã¦ã„ãé ˜åŸŸã§ã™ã€‚",

      "AIRï½œã—ãã¿ã‚’çµ„ã‚€é ˜åŸŸ":
        "ä¸€æ­©å¼•ã„ãŸè¦–ç‚¹ã§å…¨ä½“ã‚’è¦‹æ¸¡ã—ã€ã€Œã—ãã¿ã€ã‚„ã€Œæ„å‘³ã€ã‚’çµ„ã¿ç«‹ã¦ã‚‹ã‚¨ãƒªã‚¢ã€‚åˆ†æãƒ»å­¦ã³ãƒ»æˆ¦ç•¥ã¥ãã‚Šã§ã€æœ¬è³ªã‚’ã¨ã‚‰ãˆã¦ã„ãé ˜åŸŸã§ã™ã€‚",

      "WATERï½œçµ†ã‚’è‚²ã¦ã‚‹é ˜åŸŸ":
        "äººã®å¿ƒã‚„é–¢ä¿‚æ€§ã«æ°´ã‚’ãããã€ã‚†ã£ãã‚Šã¨çµ†ã‚’è‚²ã¦ã¦ã„ãã‚¨ãƒªã‚¢ã€‚å…±æ„Ÿãƒ»ã‚µãƒãƒ¼ãƒˆãƒ»ãƒãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’é€šã—ã¦ã€å®‰å¿ƒã§ãã‚‹ã¤ãªãŒã‚Šã‚’ã¤ãã‚‹é ˜åŸŸã§ã™ã€‚"
    };

    // è‰²è¨­å®šï¼ˆEARTH=ç´«, FIRE=ã‚ªãƒ¬ãƒ³ã‚¸, AIR=ç·‘, WATER=æ°´è‰²ï¼‰
    const domainColors = {
      "EARTHï½œå½¢ã«ã™ã‚‹é ˜åŸŸ": "#8B5CF6",
      "FIREï½œäººã¨å ´ã‚’å‹•ã‹ã™é ˜åŸŸ": "#F97316",
      "AIRï½œã—ãã¿ã‚’çµ„ã‚€é ˜åŸŸ":   "#22C55E",
      "WATERï½œçµ†ã‚’è‚²ã¦ã‚‹é ˜åŸŸ":   "#38BDF8"
    };

    const elementDisplayNames = {
      EARTH: "EARTHï½œå½¢ã«ã™ã‚‹é ˜åŸŸ",
      FIRE:  "FIREï½œäººã¨å ´ã‚’å‹•ã‹ã™é ˜åŸŸ",
      AIR:   "AIRï½œã—ãã¿ã‚’çµ„ã‚€é ˜åŸŸ",
      WATER: "WATERï½œçµ†ã‚’è‚²ã¦ã‚‹é ˜åŸŸ"
    };

    const starElementLabels = {
      FIRE:  "FIREï¼ˆç«ï¼‰ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ",
      EARTH: "EARTHï¼ˆåœŸï¼‰ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ",
      AIR:   "AIRï¼ˆé¢¨ï¼‰ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ",
      WATER: "WATERï¼ˆæ°´ï¼‰ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ"
    };

    // 8è»¸ã®çŸ­ã„èª¬æ˜ï¼ˆä¸€è¦§ç”¨ï¼‰
    const axisDescriptions = {
      X1: "ã‚„ã‚‹ã“ã¨ã‚’æ•´ç†ã—ã€æµã‚Œã‚„æ‰‹é †ã‚’çµ„ã¿ç«‹ã¦ã‚‹åŠ›ã€‚æ®µå–ã‚Šãƒ»ä»•çµ„ã¿åŒ–ãƒ»åœŸå°ã¥ãã‚ŠãŒå¾—æ„ãªè»¸ã§ã™ã€‚",
      X2: "æ±ºã‚ãŸã“ã¨ã‚’ç²˜ã‚Šå¼·ãã‚„ã‚Šåˆ‡ã‚‹åŠ›ã€‚ã‚³ãƒ„ã‚³ãƒ„ç¶šã‘ã‚‹ãƒ»æœ€å¾Œã¾ã§çµ‚ã‚ã‚‰ã›ã‚‹ã¨ã“ã‚ã§åŠ›ã‚’ç™ºæ®ã™ã‚‹è»¸ã§ã™ã€‚",
      I1: "è¨€è‘‰ã‚„å­˜åœ¨æ„Ÿã§å ´ã‚’æ˜ã‚‹ãã™ã‚‹åŠ›ã€‚å‰ã«å‡ºã¦è©±ã—ãŸã‚Šã€é›°å›²æ°—ã‚’ã‚ãŸãŸã‚ãŸã‚Šã™ã‚‹è»¸ã§ã™ã€‚",
      I2: "äººã‚’ç´å¾—ã•ã›ã€å·»ãè¾¼ã¿ãªãŒã‚‰å‰ã«é€²ã‚ã‚‹åŠ›ã€‚æ¨é€²å½¹ãƒ»ã¾ã¨ã‚å½¹ã¨ã—ã¦åƒãè»¸ã§ã™ã€‚",
      T1: "æƒ…å ±ã‚„å‡ºæ¥äº‹ã‚’æ•´ç†ã—ã€æ§‹é€ åŒ–ã—ã¦è€ƒãˆã‚‹åŠ›ã€‚ãƒ­ã‚¸ã‚«ãƒ«ã«åˆ†æã—ã¦åˆ¤æ–­ã™ã‚‹è»¸ã§ã™ã€‚",
      T2: "æ·±ãå­¦ã³ã€æ¢ç©¶ã—ç¶šã‘ã‚‹åŠ›ã€‚çŸ¥è­˜ã‚„çµŒé¨“ã‚’è“„ãˆã¦ã€è‡ªåˆ†ãªã‚Šã«ç†è§£ã‚’æ·±ã‚ã¦ã„ãè»¸ã§ã™ã€‚",
      R1: "äººã®æ°—æŒã¡ã«æ°—ã¥ãã€ãã£ã¨å¯„ã‚Šãã†åŠ›ã€‚1å¯¾1ã®ä¿¡é ¼é–¢ä¿‚ã‚„ã‚±ã‚¢ã§åŠ›ã‚’ç™ºæ®ã™ã‚‹è»¸ã§ã™ã€‚",
      R2: "äººã¨ä¸€ç·’ã«é€²ã‚ã€ãƒãƒ¼ãƒ ã¨ã—ã¦ã†ã¾ãå›ã™åŠ›ã€‚èª¿æ•´ãƒ»ã‚µãƒãƒ¼ãƒˆãƒ»ãƒãƒ¼ãƒ ãƒ“ãƒ«ãƒ‡ã‚£ãƒ³ã‚°ã®è»¸ã§ã™ã€‚"
    };

    // 8è»¸ã®è©³ã—ã„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
    const axisLongFeedback = {
      X1: "ã€Œå¤§åœ°ã®ãƒ‡ã‚¶ã‚¤ãƒ³è»¸ã€ã¯ã€å…¨ä½“ã®æµã‚Œã‚„æ‰‹é †ã‚’çµ„ã¿ç«‹ã¦ã‚‹åŠ›ã¨ã—ã¦è¡¨ã‚Œã¾ã™ã€‚ã‚„ã‚‹ã“ã¨ã‚’æ•´ç†ã—ãŸã‚Šã€ã‚¿ã‚¹ã‚¯ã‚’ä¸¦ã¹æ›¿ãˆãŸã‚Šã€ã€Œã“ã®é †ç•ªã§é€²ã‚ã‚‹ã¨ã‚¹ãƒ ãƒ¼ã‚ºã€ã¨ç›´æ„Ÿçš„ã«çµ„ã¿ç«‹ã¦ãŸã‚Šã™ã‚‹å ´é¢ãŒå¤šã„ã¯ãšã§ã™ã€‚é ­ã®ä¸­ã§æ®µå–ã‚Šã‚’çµ„ã¿ãªãŒã‚‰å‹•ãã®ã§ã€å‘¨ã‚Šã‹ã‚‰è¦‹ã‚‹ã¨ã€Œæº–å‚™ãŒæŠœã‹ã‚Šãªã„äººã€ã€Œå®‰å¿ƒã—ã¦ä»»ã›ã‚‰ã‚Œã‚‹äººã€ã¨æ˜ ã‚Šã‚„ã™ã„æ‰èƒ½ã§ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®è¨­è¨ˆã‚„ã€ç‰©äº‹ã®é€²ã‚æ–¹ã‚’æ•´ãˆã‚‹å½¹å‰²ã§åŠ›ã‚’ç™ºæ®ã—ã‚„ã™ã„è»¸ã¨è¨€ãˆã¾ã™ã€‚",
      X2: "ã€Œå¤§åœ°ã®å®Ÿè¡Œè»¸ã€ã¯ã€ä¸€åº¦æ±ºã‚ãŸã“ã¨ã‚’æœ€å¾Œã¾ã§ã‚„ã‚Šåˆ‡ã‚‹åŠ›ã¨ã—ã¦è¡¨ã‚Œã¾ã™ã€‚é€”ä¸­ã§æ­¢ã¾ã£ã¦ã„ã‚‹ã‚¿ã‚¹ã‚¯ãŒã‚ã‚‹ã¨è½ã¡ç€ã‹ãªã‹ã£ãŸã‚Šã€ã€Œã©ã†ã›ã‚„ã‚‹ãªã‚‰ã¡ã‚ƒã‚“ã¨çµ‚ã‚ã‚‰ã›ãŸã„ã€ã¨æ„Ÿã˜ã‚‹ã“ã¨ãŒå¤šã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚å‘¨ã‚ŠãŒé£½ãã¦ããŸã“ã‚ã«ã‚‚ã‚³ãƒ„ã‚³ãƒ„ã¨ç©ã¿ä¸Šã’ã‚’ç¶šã‘ã‚‰ã‚Œã‚‹ã®ã§ã€é•·æœŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚„è£å´ã§è³ªã‚’å®ˆã‚‹å½¹å‰²ã§ä¿¡é ¼ã•ã‚Œã‚„ã™ã„æ‰èƒ½ã§ã™ã€‚ã€Œç¶šã‘ã‚‹ã€ã€Œå®Œäº†ã•ã›ã‚‹ã€ã¨ã„ã†å‹•ããã®ã‚‚ã®ãŒã€ã‚ãªãŸãªã‚‰ã§ã¯ã®å¼·ã¿ã«ãªã£ã¦ã„ã‚‹è»¸ã§ã™ã€‚",
      I1: "ã€Œç«ã®ç™ºä¿¡è»¸ã€ã¯ã€è¨€è‘‰ã‚„è¡¨æƒ…ã€é›°å›²æ°—ãã®ã‚‚ã®ã‚’ä½¿ã£ã¦å ´ã«ç«ã‚’ç¯ã™åŠ›ã¨ã—ã¦è¡¨ã‚Œã¾ã™ã€‚æ²ˆã‚“ã ç©ºæ°—ã‚’å¤‰ãˆãŸã‚Šã€ã€Œã“ã‚“ãªã“ã¨ã‚„ã‚ã†ã‚ˆã€ã¨è©±é¡Œã‚’æŠ•ã’ã‹ã‘ãŸã‚Šã€æ°—ã¥ã‘ã°å ´ã®æ¸©åº¦ã‚’ä¸Šã’ã¦ã„ã‚‹å ´é¢ãŒå¤šã„ã¯ãšã§ã™ã€‚å®Œç’§ãªã‚¹ãƒ”ãƒ¼ãƒã§ãªãã¦ã‚‚ã€æ—¥å¸¸ã®ä¸€è¨€ã‚„SNSã®æŠ•ç¨¿ãªã©ã€ãƒ©ã‚¤ãƒˆãªç™ºä¿¡ã§ã‚‚å‘¨ã‚Šã«å½±éŸ¿ã‚’ä¸ãˆã‚„ã™ã„ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ã‚ãªãŸã®ç­‰èº«å¤§ã®è¨€è‘‰ãŒã€èª°ã‹ã®å¿ƒã«å°ã•ãªç«ã‚’ç¯ã—ã¦ã„ã‚‹è»¸ã§ã™ã€‚",
      I2: "ã€Œç«ã®æ¨é€²è»¸ã€ã¯ã€äººã‚„å ´ã‚’å·»ãè¾¼ã‚“ã§å‰ã«é€²ã‚ã¦ã„ãåŠ›ã§ã™ã€‚çŠ¶æ³ã‚’è¦‹ãªãŒã‚‰ã€Œã˜ã‚ƒã‚ã€ã“ã†ã—ã¦ã¿ã‚ˆã†ã€ã€Œã¨ã‚Šã‚ãˆãšã“ã“ã¾ã§é€²ã‚ã¦ã¿ã‚ˆã†ã€ã¨æµã‚Œã‚’ã¤ãã‚‹ã“ã¨ãŒã§ãã‚‹ã®ã§ã€æ°—ã¥ãã¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èˆµå–ã‚Šå½¹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚‚å¤šã„ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ã‚ãªãŸã®ä¸­ã®ãƒ¯ã‚¯ãƒ¯ã‚¯ã‚„ã€Œã“ã‚Œã€çµ¶å¯¾ãŠã‚‚ã—ã‚ã„ã€ãŒç‚¹ç«ã™ã‚‹ã¨ã€ãã®ç«ã¯å‘¨ã‚Šã«ã‚‚ä¼æŸ“ã—ã¦ã„ãã¾ã™ã€‚èƒŒä¸­ã‚’æŠ¼ã—ã¦ã»ã—ã„äººãŸã¡ã®ã€å¿ƒå¼·ã„æ¨é€²åŠ›ã«ãªã£ã¦ã„ã‚‹è»¸ã§ã™ã€‚",
      T1: "ã€Œé¢¨ã®åˆ†æè»¸ã€ã¯ã€ç‰©äº‹ã‚’æ„Ÿè¦šã ã‘ã§æ‰ãˆã‚‹ã®ã§ã¯ãªãã€ã€Œãªãœãã†ãªã‚‹ã®ã‹ã€ã€Œä»–ã«ã©ã‚“ãªé¸æŠè‚¢ãŒã‚ã‚‹ã®ã‹ã€ã‚’è€ƒãˆã‚‹åŠ›ã¨ã—ã¦è¡¨ã‚Œã¾ã™ã€‚æƒ…å ±ã‚„å‡ºæ¥äº‹ã‚’æ•´ç†ã—ã€å› æœé–¢ä¿‚ã‚„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è¦‹æŠœãã“ã¨ãŒå¾—æ„ã§ã€è¤‡é›‘ãªçŠ¶æ³ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«æ‰ãˆç›´ã™ã“ã¨ãŒã§ãã¾ã™ã€‚æ„Ÿæƒ…ã«æµã•ã‚Œã«ãã„ãŸã‚ã€å‘¨å›²ã®æš´èµ°ã‚’æ­¢ã‚ãŸã‚Šã€ãƒªã‚¹ã‚¯ã«æ—©ã‚ã«æ°—ã¥ã„ãŸã‚Šã™ã‚‹å½¹å‰²ã‚‚æ‹…ã„ã‚„ã™ã„ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ã€Œã‚ˆãè€ƒãˆã‚‹ã€ã€Œå†·é™ã«è¦‹ã¦ã„ã‚‹ã€è¦–ç‚¹ãã®ã‚‚ã®ãŒå¼·ã¿ã«ãªã£ã¦ã„ã‚‹è»¸ã§ã™ã€‚",
      T2: "ã€Œé¢¨ã®æ¢ç©¶è»¸ã€ã¯ã€èˆˆå‘³ã‚’æŒã£ãŸãƒ†ãƒ¼ãƒã‚’ã©ã“ã¾ã§ã‚‚æ·±ãè¿½ã„ã‹ã‘ã‚‹åŠ›ã¨ã—ã¦åƒãã¾ã™ã€‚ã€Œãªãœï¼Ÿã€ã€Œã©ã†ã—ã¦ãã†ãªã‚‹ã®ï¼Ÿã€ã¨è€ƒãˆå§‹ã‚ã‚‹ã¨ã€è‡ªåˆ†ã§ã‚‚æ­¢ã¾ã‚‰ãªã„ã¨æ„Ÿã˜ã‚‹ã“ã¨ãŒã‚ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚æœ¬ã‚„è¬›åº§ã€å®Ÿä½“é¨“ãªã©ã‚’é€šã—ã¦ã‚¤ãƒ³ãƒ—ãƒƒãƒˆã—ãŸã‚‚ã®ã‚’ã€è‡ªåˆ†ãªã‚Šã®è¨€è‘‰ã‚„ãƒãƒ¼ãƒˆã§æ•´ç†ã—ã¦ã„ãã“ã¨ãŒå¤šãã€ãã®åˆ†é‡ã§ã¯è‡ªç„¶ã¨å‘¨ã‚Šã‚ˆã‚Šè©³ã—ããªã£ã¦ã„ãã¾ã™ã€‚çŸ¥ã‚‹ã“ã¨ãƒ»ç†è§£ãŒæ·±ã¾ã‚‹ã“ã¨è‡ªä½“ã‚’æ¥½ã—ã‚ã‚‹è»¸ã§ã™ã€‚",
      R1: "ã€Œæ°´ã®å…±æ„Ÿè»¸ã€ã¯ã€äººã®è¡¨æƒ…ã‚„å£°ã®ãƒˆãƒ¼ãƒ³ã€ã¡ã‚‡ã£ã¨ã—ãŸæ²ˆé»™ã®å¤‰åŒ–ã«æ•æ„Ÿã«æ°—ã¥ãåŠ›ã¨ã—ã¦è¡¨ã‚Œã¾ã™ã€‚ç›¸æ‰‹ã®å†…å´ã§èµ·ãã¦ã„ã‚‹ã“ã¨ã«è€³ã‚’æ¾„ã¾ã—ãªãŒã‚‰è©±ã‚’è´ãã®ã§ã€ã€Œã¡ã‚ƒã‚“ã¨ã‚ã‹ã£ã¦ãã‚Œã‚‹äººã€ã¨æ„Ÿã˜ã¦ã‚‚ã‚‰ã„ã‚„ã™ã„ã‚¿ã‚¤ãƒ—ã§ã™ã€‚ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ã™ã‚‹å‰ã«ã€ã¾ãšå—ã‘æ­¢ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ãŸã‚ã€1å¯¾1ã®é–¢ä¿‚æ€§ã®ä¸­ã§ä¿¡é ¼ã‚’è‚²ã¦ã‚„ã™ã„æ‰èƒ½ã‚’æŒã£ã¦ã„ã¾ã™ã€‚å¯„ã‚Šãã†ã“ã¨ãã®ã‚‚ã®ãŒã€ã‚ãªãŸã®ã‚®ãƒ•ãƒˆã«ãªã£ã¦ã„ã‚‹è»¸ã§ã™ã€‚",
      R2: "ã€Œæ°´ã®ãƒãƒ¼ãƒ è»¸ã€ã¯ã€ã€Œã¿ã‚“ãªãŒæ°—æŒã¡ã‚ˆãå‹•ã‘ã‚‹ç©ºæ°—ã€ã‚’ã¤ãã‚‹åŠ›ã¨ã—ã¦è¡¨ã‚Œã¾ã™ã€‚é–¢ä¿‚æ€§å…¨ä½“ã®ãƒãƒ©ãƒ³ã‚¹ã‚’è¦‹ãªãŒã‚‰ã€è‡ªç„¶ã«ãƒ•ã‚©ãƒ­ãƒ¼ã‚„èª¿æ•´ã«å›ã‚‹ã“ã¨ãŒå¤šãã€å ´ãŒã‚®ã‚¹ã‚®ã‚¹ã—ã¦ã„ã‚‹ã¨ãã«æŸ”ã‚‰ã‹ã„ä¸€è¨€ã‚’å·®ã—è¾¼ã‚“ã ã‚Šã€è£å´ã§ã‚µãƒãƒ¼ãƒˆå½¹ã«å›ã£ãŸã‚Šã™ã‚‹ã“ã¨ã§ã€ãƒãƒ¼ãƒ å…¨ä½“ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’åº•ä¸Šã’ã—ã¦ã„ãã¾ã™ã€‚ã‚ãŸã‚Šå‰ã®ã‚ˆã†ã«ã‚„ã£ã¦ã„ã‚‹èª¿æ•´ã‚„å£°ã‹ã‘ãŒã€å®Ÿã¯å¤§ããªä¾¡å€¤ã«ãªã£ã¦ã„ã‚‹è»¸ã§ã™ã€‚"
    };

    // â˜…ä¸Šä½3è»¸ã®æ›ã‘åˆã‚ã›ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆå‰ã¨åŒã˜ï¼šé•·ã„ã®ã§çœç•¥ã›ãšå…¨éƒ¨æ®‹ã—ã¦ã‚ã‚‹ï¼‰
    const comboMessages = { /* ã“ã“ã¯å‰å›ã¨åŒã˜å†…å®¹ã€‚é•·ã„ã®ã§ãã®ã¾ã¾æ®‹ã—ã¦ã„ã¾ã™ */ };

    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®3è»¸ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    function buildDefaultTop3Message(top3) {
      if (!top3 || top3.length === 0) return "";
      const names = top3.map(a => a.label);
      return `ã‚ãªãŸã®ä»Šã®ãƒ¡ã‚¤ãƒ³ã®æ‰èƒ½ã¯ã€Œ${names.join("ã€ã€Œ")}ã€ã®3ã¤ã§ã™ã€‚ã“ã‚Œã¯ã€ã‚ãªãŸãŒç„¡æ„è­˜ã«ä½¿ã£ã¦ã„ã‚‹æ‰èƒ½ã§ã‚ã‚Šã€ã€Œé ‘å¼µã‚‰ãªãã¦ã‚‚è‡ªç„¶ã¨æ´»ç”¨ã§ãã‚‹ã€é ˜åŸŸã§ã‚‚ã‚ã‚Šã¾ã™ã€‚ã“ã®3ã¤ã¯ã€ãã‚Œãã‚Œå˜ä½“ã§ã‚‚åŠ›ã‚’æŒã£ã¦ã„ã¾ã™ãŒã€åŒæ™‚ã«åƒãã“ã¨ã§ã‚ãªãŸãªã‚‰ã§ã¯ã®ãƒªã‚ºãƒ ã¨ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ã¤ãã‚Šã¾ã™ã€‚æ—¥å¸¸ã®ä¸­ã§ã€Œã—ã£ãã‚Šãã‚‹å‹•ãæ–¹ã€ã‚„ã€Œã¤ã„å¼•ãå—ã‘ãŒã¡ãªå½¹å‰²ã€ã‚’æ€ã„å‡ºã—ã¦ã¿ã‚‹ã¨ã€ãã“ã«ã¯å¿…ãšã“ã®3ã¤ã®è»¸ã®ã‚¨ãƒƒã‚»ãƒ³ã‚¹ãŒé‡ãªã£ã¦ã„ã¾ã™ã€‚`;
    }

    // ---- 12æ˜Ÿåº§ ----
    const zodiacInfos = {
      ARIES:   { id:"ARIES",   name:"ç‰¡ç¾Šåº§", element:"FIRE",  description:"ã‚¹ã‚¿ãƒ¼ãƒˆãƒ€ãƒƒã‚·ãƒ¥ãƒ»ãƒãƒ£ãƒ¬ãƒ³ã‚¸ç²¾ç¥ãƒ»ç‡ç›´ã•ãŒãƒ†ãƒ¼ãƒã«ãªã‚Šã‚„ã™ã„æ˜Ÿåº§ã§ã™ã€‚" },
      TAURUS:  { id:"TAURUS",  name:"ç‰¡ç‰›åº§", element:"EARTH", description:"äº”æ„Ÿã®å¿ƒåœ°ã‚ˆã•ã‚„å®‰å®šæ„Ÿã€ãƒã‚¤ãƒšãƒ¼ã‚¹ã•ã‚’å¤§åˆ‡ã«ã™ã‚‹æ˜Ÿåº§ã§ã™ã€‚" },
      GEMINI:  { id:"GEMINI",  name:"åŒå­åº§", element:"AIR",   description:"å¥½å¥‡å¿ƒæ—ºç››ã§ã€æƒ…å ±ã‚„ä¼šè©±ã‚’é€šã˜ã¦ä¸–ç•Œã‚’åºƒã’ã¦ã„ãæ˜Ÿåº§ã§ã™ã€‚" },
      CANCER:  { id:"CANCER",  name:"èŸ¹åº§",   element:"WATER", description:"èº«è¿‘ãªäººã‚„å±…å ´æ‰€ã‚’å®ˆã‚Šã€ã‚ãŸãŸã‹ã„é–¢ä¿‚æ€§ã‚’è‚²ã¦ã‚‹æ˜Ÿåº§ã§ã™ã€‚" },
      LEO:     { id:"LEO",     name:"ç…å­åº§", element:"FIRE",  description:"è‡ªå·±è¡¨ç¾ã‚„ãƒ‰ãƒ©ãƒãƒãƒƒã‚¯ã•ã‚’é€šã—ã¦ã€å‘¨ã‚Šã‚’ç…§ã‚‰ã—ã¦ã„ãæ˜Ÿåº§ã§ã™ã€‚" },
      VIRGO:   { id:"VIRGO",   name:"ä¹™å¥³åº§", element:"EARTH", description:"ç´°ã‚„ã‹ãªæ°—é…ã‚Šã¨å®Ÿå‹™åŠ›ã§ã€ç¾å ´ã‚’æ•´ãˆã‚‹ã“ã¨ã«é•·ã‘ãŸæ˜Ÿåº§ã§ã™ã€‚" },
      LIBRA:   { id:"LIBRA",   name:"å¤©ç§¤åº§", element:"AIR",   description:"ãƒãƒ©ãƒ³ã‚¹æ„Ÿè¦šã¨å¯¾è©±åŠ›ã§ã€äººã¨äººã®é–“ã‚’ã¤ãªã„ã§ã„ãæ˜Ÿåº§ã§ã™ã€‚" },
      SCORPIO: { id:"SCORPIO", name:"è åº§",   element:"WATER", description:"ç‰©äº‹ã‚„äººã¨æ·±ãå‘ãåˆã„ã€æœ¬è³ªã«è¿«ã£ã¦ã„ãåŠ›ã‚’æŒã¤æ˜Ÿåº§ã§ã™ã€‚" },
      SAGITTARIUS:{id:"SAGITTARIUS",name:"å°„æ‰‹åº§",element:"FIRE",description:"è‡ªç”±ãªæ¢ç©¶å¿ƒã¨ã‚¹ã‚±ãƒ¼ãƒ«ã®å¤§ããªãƒ“ã‚¸ãƒ§ãƒ³ã§ã€ä¸–ç•Œã‚’åºƒã’ã¦ã„ãæ˜Ÿåº§ã§ã™ã€‚"},
      CAPRICORN:{ id:"CAPRICORN",name:"å±±ç¾Šåº§", element:"EARTH",description:"ç›®çš„é”æˆã«å‘ã‘ã¦ã€é•·æœŸçš„ã«ã‚³ãƒ„ã‚³ãƒ„ç©ã¿ä¸Šã’ã¦ã„ãæ˜Ÿåº§ã§ã™ã€‚" },
      AQUARIUS:{ id:"AQUARIUS", name:"æ°´ç“¶åº§", element:"AIR",   description:"æ—¢å­˜ã®æ ã«ã¨ã‚‰ã‚ã‚Œãšã€æ–°ã—ã„ä¾¡å€¤è¦³ã‚„ã¤ãªãŒã‚Šã‚’ç”Ÿã¿å‡ºã™æ˜Ÿåº§ã§ã™ã€‚" },
      PISCES:  { id:"PISCES",  name:"é­šåº§",   element:"WATER", description:"æ„Ÿå—æ€§ãŒè±Šã‹ã§ã€å¢ƒç•Œã‚’è¶…ãˆã¦å…±æ„Ÿã—ã€ç™’ã—ã‚’ã‚‚ãŸã‚‰ã™æ˜Ÿåº§ã§ã™ã€‚" }
    };

    function getZodiacFromBirthdate(dateStr) {
      if (!dateStr) return null;
      const parts = dateStr.split("-");
      if (parts.length < 3) return null;
      const month = parseInt(parts[1], 10);
      const day   = parseInt(parts[2], 10);
      if (!month || !day) return null;

      if ((month === 3 && day >= 21) || (month === 4 && day <= 19)) return zodiacInfos.ARIES;
      if ((month === 4 && day >= 20) || (month === 5 && day <= 20)) return zodiacInfos.TAURUS;
      if ((month === 5 && day >= 21) || (month === 6 && day <= 21)) return zodiacInfos.GEMINI;
      if ((month === 6 && day >= 22) || (month === 7 && day <= 22)) return zodiacInfos.CANCER;
      if ((month === 7 && day >= 23) || (month === 8 && day <= 22)) return zodiacInfos.LEO;
      if ((month === 8 && day >= 23) || (month === 9 && day <= 22)) return zodiacInfos.VIRGO;
      if ((month === 9 && day >= 23) || (month === 10 && day <= 23)) return zodiacInfos.LIBRA;
      if ((month === 10 && day >= 24) || (month === 11 && day <= 22)) return zodiacInfos.SCORPIO;
      if ((month === 11 && day >= 23) || (month === 12 && day <= 21)) return zodiacInfos.SAGITTARIUS;
      if ((month === 12 && day >= 22) || (month === 1 && day <= 19)) return zodiacInfos.CAPRICORN;
      if ((month === 1 && day >= 20) || (month === 2 && day <= 18)) return zodiacInfos.AQUARIUS;
      if ((month === 2 && day >= 19) || (month === 3 && day <= 20)) return zodiacInfos.PISCES;
      return null;
    }

    function getElementKeyFromDomainName(domainName) {
      if (!domainName) return null;
      if (domainName.startsWith("EARTH")) return "EARTH";
      if (domainName.startsWith("FIRE"))  return "FIRE";
      if (domainName.startsWith("AIR"))   return "AIR";
      if (domainName.startsWith("WATER")) return "WATER";
      return null;
    }

    // æ˜ŸÃ—æ‰èƒ½ 16ã‚¿ã‚¤ãƒ—ï¼ˆé•·æ–‡ã¤ãï¼‰â˜…å‰å›ã¨åŒã˜å†…å®¹
    const talentStarTypes = { /* ã“ã“ã‚‚å‰å›ã®é•·æ–‡ã‚’ãã®ã¾ã¾å…¥ã‚Œã¦ãã ã•ã„ */ };

    // ---- è³ªå•å®šç¾© ----
    const questions = [
      // X1 å¤§åœ°ã®ãƒ‡ã‚¶ã‚¤ãƒ³è»¸
      { id: 1, axis: "X1", text: "ã‚„ã‚‹ã“ã¨ã‚’ç´™ã‚„ã‚¢ãƒ—ãƒªã«ãƒªã‚¹ãƒˆåŒ–ã—ã¦ã‹ã‚‰è¡Œå‹•ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚" },
      { id: 2, axis: "X1", text: "ç‰©äº‹ã‚’é€²ã‚ã‚‹å‰ã«ã€æ‰‹é †ã‚„æµã‚Œã‚’æ•´ç†ã—ãŸããªã‚‹ã€‚" },
      { id: 3, axis: "X1", text: "ã€Œã“ã®é †ç•ªã§ã‚„ã‚‹ã¨åŠ¹ç‡ãŒã„ã„ã€ã¨è€ƒãˆãªãŒã‚‰å‹•ã„ã¦ã„ã‚‹ã€‚" },
      { id: 4, axis: "X1", text: "ä»•äº‹ã‚„å®¶äº‹ã®ã‚„ã‚Šæ–¹ã‚’ã€ã‚‚ã£ã¨æ¥½ã«ãªã‚‹ã‚ˆã†ã«å·¥å¤«ã™ã‚‹ã®ãŒå¥½ãã ã€‚" },
      { id: 5, axis: "X1", text: "ã¿ã‚“ãªãŒè¿·ã‚ãªã„ã‚ˆã†ã«ã€ãƒ«ãƒ¼ãƒ«ã‚„ä»•çµ„ã¿ã‚’æ•´ãˆãŸããªã‚‹ã€‚" },
      { id: 6, axis: "X1", text: "ã‚´ãƒ¼ãƒ«ã‹ã‚‰é€†ç®—ã—ã¦ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’çµ„ã‚€ã®ãŒå¾—æ„ã ã¨æ„Ÿã˜ã‚‹ã€‚" },

      // X2 å¤§åœ°ã®å®Ÿè¡Œè»¸
      { id: 7, axis: "X2", text: "é€”ä¸­ã§æŠ•ã’å‡ºã™ã®ãŒå«Œã§ã€ã¤ã„æœ€å¾Œã¾ã§ã‚„ã‚Šåˆ‡ã£ã¦ã—ã¾ã†ã€‚" },
      { id: 8, axis: "X2", text: "ç· ã‚åˆ‡ã‚ŠãŒè¿‘ã¥ãã¨ã€ã‚€ã—ã‚é›†ä¸­åŠ›ãŒé«˜ã¾ã‚‹ã»ã†ã ã€‚" },
      { id: 9, axis: "X2", text: "ã€Œé€”ä¸­ã¾ã§ã‚„ã£ã¦æ”¾ç½®ã€ãŒæ°—æŒã¡æ‚ªãæ„Ÿã˜ã‚‹ã€‚" },
      { id: 10, axis: "X2", text: "å¤§å¤‰ã§ã‚‚ã€ä¸€åº¦å¼•ãå—ã‘ãŸã“ã¨ã¯ã‚„ã‚Šé‚ã’ãŸã„ã¨æ€ã†ã€‚" },
      { id: 11, axis: "X2", text: "äººã‹ã‚‰é ¼ã¾ã‚ŒãŸã“ã¨ã‚’å¿˜ã‚Œãªã„ã‚ˆã†ã€ãã¡ã‚“ã¨çµ‚ã‚ã‚‰ã›ã‚ˆã†ã¨ã™ã‚‹ã€‚" },
      { id: 12, axis: "X2", text: "é•·æœŸçš„ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã‚‚ã€ã‚³ãƒ„ã‚³ãƒ„ç¶šã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚" },

      // I1 ç«ã®ç™ºä¿¡è»¸
      { id: 13, axis: "I1", text: "äººå‰ã§è©±ã™ã“ã¨ã«ã€ãã“ã¾ã§å¼·ã„æŠµæŠ—ã¯ãªã„ã€‚" },
      { id: 14, axis: "I1", text: "è‡ªåˆ†ã®è€ƒãˆã‚„çµŒé¨“ã‚’ã€SNSã‚„ãƒ–ãƒ­ã‚°ãªã©ã§ç™ºä¿¡ã—ãŸããªã‚‹ã€‚" },
      { id: 15, axis: "I1", text: "å ´ãŒé™ã‹ã™ãã‚‹ã¨ã€ã¤ã„è©±é¡Œã‚’æŒ¯ã£ãŸã‚Šç››ã‚Šä¸Šã’ãŸã‚Šã—ã¦ã—ã¾ã†ã€‚" },
      { id: 16, axis: "I1", text: "è‡ªåˆ†ã®æ„è¦‹ã‚’ãƒãƒƒã‚­ãƒªè¨€ã†æ–¹ã ã¨æ€ã†ã€‚" },
      { id: 17, axis: "I1", text: "åˆå¯¾é¢ã®äººã¨ã‚‚ã€ã‚ã‚Šã¨ã™ãã«ä¼šè©±ã‚’åºƒã’ã‚‰ã‚Œã‚‹ã€‚" },
      { id: 18, axis: "I1", text: "ã€Œã‚ãªãŸãŒã„ã‚‹ã¨å ´ã®é›°å›²æ°—ãŒæ˜ã‚‹ããªã‚‹ã€ã¨è¨€ã‚ã‚ŒãŸã“ã¨ãŒã‚ã‚‹ã€‚" },

      // I2 ç«ã®æ¨é€²è»¸
      { id: 19, axis: "I2", text: "ã¿ã‚“ãªã®æ„è¦‹ã‚’èã„ãŸã†ãˆã§ã€ã€Œã˜ã‚ƒã‚ã“ã†ã—ã‚ˆã†ã€ã¨æ–¹å‘æ€§ã‚’ç¤ºã™ã“ã¨ãŒå¤šã„ã€‚" },
      { id: 20, axis: "I2", text: "ä¼ç”»ã‚„ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ã€äººã«åˆ†ã‹ã‚Šã‚„ã™ããƒ—ãƒ¬ã‚¼ãƒ³ã™ã‚‹ã®ãŒå¥½ãã ã€‚" },
      { id: 21, axis: "I2", text: "ç›¸æ‰‹ã«ç´å¾—ã—ã¦ã‚‚ã‚‰ãˆã‚‹èª¬æ˜ã®ä»•æ–¹ã‚’è€ƒãˆã‚‹ã®ãŒå¾—æ„ã ã€‚" },
      { id: 22, axis: "I2", text: "ãƒãƒ¼ãƒ ã‚„å‘¨å›²ã‚’å·»ãè¾¼ã¿ãªãŒã‚‰ã€ç‰©äº‹ã‚’å‰ã«é€²ã‚ã‚‹ã®ãŒå¥½ãã ã€‚" },
      { id: 23, axis: "I2", text: "è‡ªåˆ†ãŒã„ã„ã¨æ€ã£ãŸã‚‚ã®ã¯ã€äººã«ã‚‚å‹§ã‚ãŸããªã‚‹ã€‚" },
      { id: 24, axis: "I2", text: "ä¼šè­°ã‚„è©±ã—åˆã„ã§ã€æœ€çµ‚çš„ã«çµè«–ã‚’ã¾ã¨ã‚ã‚‹å½¹å‰²ã«ãªã‚‹ã“ã¨ãŒå¤šã„ã€‚" },

      // T1 é¢¨ã®åˆ†æè»¸
      { id: 25, axis: "T1", text: "æƒ…å ±ã‚’èã„ãŸã¨ãã€Œãªãœãã†ãªã‚‹ã®ã‹ï¼Ÿã€ã‚’è€ƒãˆãŸããªã‚‹ã€‚" },
      { id: 26, axis: "T1", text: "å•é¡ŒãŒèµ·ãã‚‹ã¨ã€åŸå› ã‚’åˆ†æã—ã¦å†ç™ºé˜²æ­¢ç­–ã‚’è€ƒãˆã‚‹ã€‚" },
      { id: 27, axis: "T1", text: "ãƒ‡ãƒ¼ã‚¿ã‚„æ•°å­—ã‚’è¦‹ã¦åˆ¤æ–­ã™ã‚‹ã®ãŒå¥½ãã ã€‚" },
      { id: 28, axis: "T1", text: "ç‰©äº‹ã®ãƒ¡ãƒªãƒƒãƒˆãƒ»ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚’æ•´ç†ã—ã¦ã‹ã‚‰æ±ºã‚ãŸã„ã‚¿ã‚¤ãƒ—ã ã€‚" },
      { id: 29, axis: "T1", text: "è¤‡é›‘ãªè©±ã‚’æ§‹é€ åŒ–ã—ã¦ã€å›³ã‚„ç®‡æ¡æ›¸ãã§ã¾ã¨ã‚ã‚‹ã®ãŒå¾—æ„ã ã€‚" },
      { id: 30, axis: "T1", text: "å…ˆã®ãƒªã‚¹ã‚¯ã‚„æŠœã‘æ¼ã‚Œã«ã€æ¯”è¼ƒçš„æ—©ãæ°—ã¥ãæ–¹ã ã€‚" },

      // T2 é¢¨ã®æ¢ç©¶è»¸
      { id: 31, axis: "T2", text: "èˆˆå‘³ã‚’æŒã£ãŸãƒ†ãƒ¼ãƒã¯ã€ãƒãƒƒãƒˆã‚„æœ¬ã§å¾¹åº•çš„ã«èª¿ã¹ãŸããªã‚‹ã€‚" },
      { id: 32, axis: "T2", text: "å­¦ã³ã®ãŸã‚ã®è¬›åº§ã‚„æœ¬ã«ã€ãŠé‡‘ã‚„æ™‚é–“ã‚’ä½¿ã†ã“ã¨ã«æŠµæŠ—ãŒå°‘ãªã„ã€‚" },
      { id: 33, axis: "T2", text: "ã€Œãªãœï¼Ÿã€ã€Œã©ã†ã„ã†ä»•çµ„ã¿ï¼Ÿã€ã¨æ·±ãæ˜ã‚Šä¸‹ã’ã¦è€ƒãˆã‚‹ã®ãŒå¥½ãã ã€‚" },
      { id: 34, axis: "T2", text: "ä¸€åº¦ãƒãƒã£ãŸåˆ†é‡ã«ã¤ã„ã¦ã¯ã€äººã‚ˆã‚Šè©³ã—ããªã‚ŠãŒã¡ã ã€‚" },
      { id: 35, axis: "T2", text: "æ–°ã—ã„çŸ¥è­˜ã‚„è€ƒãˆæ–¹ã«è§¦ã‚Œã‚‹ã¨ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹ã€‚" },
      { id: 36, axis: "T2", text: "å­¦ã‚“ã ã“ã¨ã‚’è‡ªåˆ†ãªã‚Šã«æ•´ç†ã—ã¦ã€ãƒ¡ãƒ¢ã‚„ãƒãƒ¼ãƒˆã«ã¾ã¨ã‚ã‚‹ã“ã¨ãŒå¤šã„ã€‚" },

      // R1 æ°´ã®å…±æ„Ÿè»¸
      { id: 37, axis: "R1", text: "äººã®è¡¨æƒ…ã‚„å£°ã®ãƒˆãƒ¼ãƒ³ã‹ã‚‰ã€æ°—æŒã¡ã®å¤‰åŒ–ã«æ•æ„Ÿã ã¨æ€ã†ã€‚" },
      { id: 38, axis: "R1", text: "æ‚©ã‚“ã§ã„ã‚‹äººã®è©±ã‚’èãã¨ã€ã¤ã„è¦ªèº«ã«ãªã£ã¦ã—ã¾ã†ã€‚" },
      { id: 39, axis: "R1", text: "ç›¸æ‰‹ãŒå‚·ã¤ã‹ãªã„ã‚ˆã†ãªè¨€ã„æ–¹ã‚’é¸ã³ãŒã¡ã ã€‚" },
      { id: 40, axis: "R1", text: "ç›¸è«‡ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„æ–¹ã ã€‚" },
      { id: 41, axis: "R1", text: "ç›¸æ‰‹ã®ç«‹å ´ã«ç«‹ã£ã¦è€ƒãˆã‚‹ç™–ãŒã‚ã‚‹ã€‚" },
      { id: 42, axis: "R1", text: "èª°ã‹ãŒç–å¤–ã•ã‚Œã¦ã„ã‚‹é›°å›²æ°—ã«æ°—ã¥ãã¨ã€æ”¾ã£ã¦ãŠã‘ãªã„ã€‚" },

      // R2 æ°´ã®ãƒãƒ¼ãƒ è»¸
      { id: 43, axis: "R2", text: "ä¸€äººã§ã‚„ã‚‹ã‚ˆã‚Šã€èª°ã‹ã¨ä¸€ç·’ã«é€²ã‚ã‚‹æ–¹ãŒã‚„ã‚‹æ°—ãŒå‡ºã‚‹ã€‚" },
      { id: 44, axis: "R2", text: "ãƒãƒ¼ãƒ ã®ãƒ¡ãƒ³ãƒãƒ¼ãã‚Œãã‚Œã®å¼·ã¿ã‚„å€‹æ€§ã‚’æ„è­˜ã—ã¦è¦‹ã¦ã„ã‚‹ã€‚" },
      { id: 45, axis: "R2", text: "å½¹å‰²åˆ†æ‹…ã‚„ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’èª¿æ•´ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚" },
      { id: 46, axis: "R2", text: "å ´ã®ç©ºæ°—ãŒã‚®ã‚¹ã‚®ã‚¹ã—ã¦ã„ã‚‹ã¨ã€ãªã‚“ã¨ã‹å’Œã‚‰ã’ãŸããªã‚‹ã€‚" },
      { id: 47, axis: "R2", text: "ã¿ã‚“ãªãŒæ°—æŒã¡ã‚ˆãåƒã‘ã‚‹ã‚ˆã†ã«ã€è£ã§ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã®ãŒå¾—æ„ã ã€‚" },
      { id: 48, axis: "R2", text: "ä¼šè­°ã‚„ä½œæ¥­ã®å‰å¾Œã«ã€ãƒ¡ãƒ³ãƒãƒ¼ã«å£°ã‚’ã‹ã‘ã¦ãƒ•ã‚©ãƒ­ãƒ¼ã™ã‚‹ã“ã¨ãŒå¤šã„ã€‚" }
    ];

    // ---- DOM ----
    const container       = document.getElementById("questionsContainer");
    const form            = document.getElementById("quizForm");
    const resultCard      = document.getElementById("resultCard");
    const resultContent   = document.getElementById("resultContent");
    const copyBtn         = document.getElementById("copyResultBtn");
    const shareBtn        = document.getElementById("shareResultBtn");
    const shareMsg        = document.getElementById("shareMessage");
    const birthDateInput  = document.getElementById("birthDate");
    const astroResultBox  = document.getElementById("astroResultBox");

    let radarChart = null;
    let latestShareText = "";
    let latestTalentElementKey = null;

    // ---- è³ªå•æç”» ----
    questions.forEach((q, index) => {
      const wrap = document.createElement("div");
      wrap.className = "question";
      // â˜…ã©ã®è³ªå•ã‹ã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã®IDã‚’æŒãŸã›ã‚‹
      wrap.dataset.qid = q.id;

      const title = document.createElement("div");
      title.className = "question-title";
      title.textContent = `${index + 1}. ${q.text}`;
      wrap.appendChild(title);

      const options = document.createElement("div");
      options.className = "options";

      const labels = [
        "1ï¼šã¾ã£ãŸãå½“ã¦ã¯ã¾ã‚‰ãªã„",
        "2ï¼šã‚ã¾ã‚Šå½“ã¦ã¯ã¾ã‚‰ãªã„",
        "3ï¼šã©ã¡ã‚‰ã¨ã‚‚ã„ãˆãªã„",
        "4ï¼šã‹ãªã‚Šå½“ã¦ã¯ã¾ã‚‹",
        "5ï¼šã¨ã¦ã‚‚å½“ã¦ã¯ã¾ã‚‹"
      ];

      for (let value = 1; value <= 5; value++) {
        const label = document.createElement("label");
        label.className = "option";
        const input = document.createElement("input");
        input.type = "radio";
        input.name = `q${q.id}`;
        input.value = value;
        label.appendChild(input);
        label.appendChild(document.createTextNode(labels[value - 1]));
        options.appendChild(label);
      }

      wrap.appendChild(options);
      container.appendChild(wrap);
    });

    // ---- æ¡ç‚¹å‡¦ç† ----
    form.addEventListener("submit", function (e) {
      e.preventDefault();

      const answers = {};
      let allAnswered = true;

      // â˜…ä¸€åº¦ã™ã¹ã¦ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’è§£é™¤
      document.querySelectorAll(".question.unanswered").forEach(div => {
        div.classList.remove("unanswered");
      });

      questions.forEach(q => {
        const selected = form.querySelector(`input[name="q${q.id}"]:checked`);
        const wrap = container.querySelector(`.question[data-qid="${q.id}"]`);
        if (!selected) {
          allAnswered = false;
          if (wrap) wrap.classList.add("unanswered");
        } else {
          answers[q.id] = Number(selected.value);
          if (wrap) wrap.classList.remove("unanswered");
        }
      });

      if (!allAnswered) {
        alert("ã¾ã ç­”ãˆã¦ã„ãªã„è³ªå•ãŒã‚ã‚Šã¾ã™ã€‚èµ¤ããªã£ã¦ã„ã‚‹ã¨ã“ã‚ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã­ã€‚");
        return;
      }

      // ã“ã“ã‹ã‚‰å…ˆã¯å‰å›ã¨åŒã˜ï¼šã‚¹ã‚³ã‚¢è¨ˆç®—ã€œè¡¨ç¤ºã¾ã§
      const axisScores = {};
      const axisMax = {};
      Object.keys(axes).forEach(axisId => {
        axisScores[axisId] = 0;
        axisMax[axisId] = 0;
      });

      questions.forEach(q => {
        const axisId = q.axis;
        axisScores[axisId] += answers[q.id];
        axisMax[axisId] += 5;
      });

      const domainScores = {};
      const domainMax = {};
      Object.values(axes).forEach(a => {
        if (!domainScores[a.domain]) {
          domainScores[a.domain] = 0;
          domainMax[a.domain] = 0;
        }
        domainScores[a.domain] += axisScores[a.id];
        domainMax[a.domain] += axisMax[a.id];
      });

      const axisResultList = Object.keys(axes).map(axisId => {
        const meta = axes[axisId];
        const raw = axisScores[axisId];
        const max = axisMax[axisId] || 1;
        const percent = Math.round(raw / max * 100);
        return {
          id: axisId,
          label: meta.label,
          domain: meta.domain,
          rawScore: raw,
          percent,
          max
        };
      }).sort((a, b) => b.percent - a.percent);

      const top3 = axisResultList.slice(0, 3);

      const domainResultList = Object.keys(domainScores).map(domainName => {
        const raw = domainScores[domainName];
        const max = domainMax[domainName] || 1;
        const percent = Math.round(raw / max * 100);
        return { domain: domainName, rawScore: raw, max, percent };
      }).sort((a, b) => b.percent - a.percent);

      const mainDomain = domainResultList[0];
      latestTalentElementKey = getElementKeyFromDomainName(mainDomain.domain);

      let html = "";

      html += `<div class="result-title">4ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã®ãƒãƒ©ãƒ³ã‚¹</div>`;
      html += `<p class="small">æ•°å­—ãŒé«˜ã„ã»ã©ã€ãã®ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã®æ‰èƒ½ã‚’ä»Šã‚ˆãä½¿ã£ã¦ã„ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ã§ã™ã€‚</p>`;

      domainResultList.forEach((d, index) => {
        const color = domainColors[d.domain] || "#4b7bec";
        html += `
          <div class="axis-row">
            <div class="axis-label">
              ${index + 1}. ${d.domain}
            </div>
            <div class="axis-bar-wrap">
              <div class="axis-bar" style="width:${d.percent}%; background:${color};"></div>
            </div>
            <div class="axis-percent">${d.percent}%</div>
          </div>
        `;
      });

      const mainElementLabel = mainDomain.domain;
      html += `<p class="small">ğŸ‘‰ ã‚ãªãŸã®<strong>ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ</strong>ã¯ã€Œ<strong>${mainElementLabel}</strong>ã€ã§ã™ã€‚</p>`;
      html += `<p class="small">${
        domainResultList.map(d =>
          `<strong>${d.domain}</strong>ï¼š${domainDescriptions[d.domain]}`
        ).join("<br>")
      }</p>`;

      html += `<hr style="margin:14px 0;">`;
      html += `<div class="result-title">4ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã¨8è»¸ã®ã¤ãªãŒã‚Š</div>`;
      html += `<p class="small">
        å„ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã¯ã€æ¬¡ã®2ã¤ã®è»¸ã§æ§‹æˆã•ã‚Œã¦ã„ã¾ã™ã€‚<br>
        EARTHï¼šå¤§åœ°ã®ãƒ‡ã‚¶ã‚¤ãƒ³è»¸ï¼å¤§åœ°ã®å®Ÿè¡Œè»¸<br>
        FIREï¼šç«ã®ç™ºä¿¡è»¸ï¼ç«ã®æ¨é€²è»¸<br>
        AIRï¼šé¢¨ã®åˆ†æè»¸ï¼é¢¨ã®æ¢ç©¶è»¸<br>
        WATERï¼šæ°´ã®å…±æ„Ÿè»¸ï¼æ°´ã®ãƒãƒ¼ãƒ è»¸
      </p>`;

      html += `<hr style="margin:14px 0;">`;
      html += `<div class="result-title">8è»¸ã®çµæœï¼ˆä¸Šä½3ã¤ãŒä»Šã®ãƒ¡ã‚¤ãƒ³æ‰èƒ½ï¼‰</div>`;

      axisResultList.forEach((a, index) => {
        const color = domainColors[a.domain] || "#4b7bec";
        html += `
          <div class="axis-row">
            <div class="axis-label">
              ${index + 1}. ${a.label}
              <span class="small">ï¼ˆ${a.domain}ï¼‰</span>
              ${index < 3 ? `<span class="badge">ãƒ¡ã‚¤ãƒ³æ‰èƒ½</span>` : ""}
            </div>
            <div class="axis-bar-wrap">
              <div class="axis-bar" style="width:${a.percent}%; background:${color};"></div>
            </div>
            <div class="axis-percent">${a.percent}%</div>
          </div>
        `;
      });

      html += `<hr style="margin:14px 0;">`;
      html += `<div class="result-title">ä¸Šä½3è»¸ã®è©³ã—ã„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯</div>`;
      top3.forEach(a => {
        const text = axisLongFeedback[a.id] || "";
        html += `
          <p class="small"><strong>${a.label}</strong>ï¼ˆ${a.domain}ï¼‰<br>${text}</p>
        `;
      });

      const comboIds = top3.map(a => a.id).sort();
      const comboKey = comboIds.join("-");
      const comboMessageText = comboMessages[comboKey] || buildDefaultTop3Message(top3);
      html += `<p class="small"><strong>3ã¤ã®æ›ã‘åˆã‚ã›ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼š</strong><br>${comboMessageText}</p>`;

      html += `<hr style="margin:14px 0;">`;
      html += `<div class="result-title">å…¨8è»¸ã®è§£èª¬</div>`;
      axisOrder.forEach(axisId => {
        const meta = axes[axisId];
        html += `
          <p>
            <strong>${meta.label}</strong>ï¼ˆ${meta.domain}ï¼‰<br>
            <span class="small">${axisDescriptions[axisId] || ""}</span>
          </p>
        `;
      });

      html += `<p class="small">â€»ã“ã®çµæœã¯ã€ã‚ãã¾ã§ã€Œä»Šã®ã‚ãªãŸãŒã‚ˆãä½¿ã£ã¦ã„ã‚‹æ‰èƒ½ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã€ã§ã™ã€‚<br>ã—ã£ãã‚Šãã‚‹ã¨ã“ã‚ãƒ»æ„å¤–ã ã£ãŸã¨ã“ã‚ã‚’ãƒ¡ãƒ¢ã—ãªãŒã‚‰ã€è‡ªåˆ†ã®çµŒé¨“ã¨ç…§ã‚‰ã—åˆã‚ã›ã¦ã¿ã¦ãã ã•ã„ã€‚</p>`;

      resultContent.innerHTML = html;
      resultCard.style.display = "block";

      let shareText = "ã€æ‰èƒ½8è»¸è¨ºæ–­ï¼‹ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆçµæœã€‘\n\n";
      shareText += "â–  4ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã®ãƒãƒ©ãƒ³ã‚¹\n";
      domainResultList.forEach(d => {
        shareText += `ãƒ»${d.domain}: ${d.percent}%\n`;
      });
      shareText += "\nâ–  ä¸Šä½3è»¸\n";
      top3.forEach(a => {
        shareText += `ãƒ»${a.label}ï¼ˆ${a.domain}ï¼‰: ${a.percent}%\n`;
      });
      shareText += "\nè¨ºæ–­ãƒ„ãƒ¼ãƒ«ã¯ã“ã¡ã‚‰ï¼š\n";
      shareText += window.location.href + "\n";

      latestShareText = shareText;
      shareMsg.textContent = "";

      const ctx = document.getElementById("domainRadar").getContext("2d");
      const labels = domainResultList.map(d => d.domain);
      const data = domainResultList.map(d => d.percent);

      if (radarChart) {
        radarChart.data.labels = labels;
        radarChart.data.datasets[0].data = data;
        radarChart.update();
      } else {
        radarChart = new Chart(ctx, {
          type: "radar",
          data: {
            labels: labels,
            datasets: [{
              label: "ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆãƒãƒ©ãƒ³ã‚¹",
              data: data,
              fill: true,
              backgroundColor: "rgba(139, 92, 246, 0.15)",
              borderColor: "rgba(139, 92, 246, 1)",
              pointBackgroundColor: "rgba(139, 92, 246, 1)"
            }]
          },
          options: {
            responsive: true,
            scales: {
              r: {
                suggestedMin: 0,
                suggestedMax: 100,
                ticks: { stepSize: 20 }
              }
            }
          }
        });
      }

      updateAstroResult();
      resultCard.scrollIntoView({ behavior: "smooth" });
    });

    // ã‚·ã‚§ã‚¢ãƒœã‚¿ãƒ³
    copyBtn.onclick = async () => {
      if (!latestShareText) {
        shareMsg.textContent = "å…ˆã«è¨ºæ–­ã‚’å®Œäº†ã—ã¦ã­ã€‚";
        return;
      }
      try {
        await navigator.clipboard.writeText(latestShareText);
        shareMsg.textContent = "çµæœãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸã€‚å¥½ããªã‚¢ãƒ—ãƒªã«è²¼ã‚Šã¤ã‘ã¦ä½¿ã£ã¦ã­ã€‚";
      } catch (e) {
        shareMsg.textContent = "ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸâ€¦ãƒ–ãƒ©ã‚¦ã‚¶ã«ã‚ˆã£ã¦ä½¿ãˆãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚";
      }
    };

    shareBtn.onclick = async () => {
      if (!latestShareText) {
        shareMsg.textContent = "å…ˆã«è¨ºæ–­ã‚’å®Œäº†ã—ã¦ã­ã€‚";
        return;
      }
      if (navigator.share) {
        try {
          await navigator.share({
            title: "æ‰èƒ½8è»¸è¨ºæ–­ çµæœ",
            text: latestShareText
          });
          shareMsg.textContent = "å…±æœ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ãã¾ã—ãŸã€‚";
        } catch (e) {
          shareMsg.textContent = "å…±æœ‰ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸã€‚";
        }
      } else {
        shareMsg.textContent = "ã“ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯å…±æœ‰æ©Ÿèƒ½ã«å¯¾å¿œã—ã¦ã„ãªã„ã®ã§ã€ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½ã‚’ä½¿ã£ã¦ã­ã€‚";
      }
    };

    // æ˜ŸÃ—æ‰èƒ½ 16ã‚¿ã‚¤ãƒ—è¡¨ç¤º
    function updateAstroResult() {
      if (!latestTalentElementKey) {
        astroResultBox.innerHTML = "<p>ã¾ãšã¯ä¸Šã®è¨ºæ–­ã§ã€æ‰èƒ½8è»¸ã®çµæœã‚’å‡ºã—ã¦ã¿ã¦ãã ã•ã„ã€‚</p>";
        return;
      }

      const dateStr = birthDateInput.value;
      if (!dateStr) {
        astroResultBox.innerHTML = "<p>ç”Ÿå¹´æœˆæ—¥ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€12æ˜Ÿåº§ã¨æ˜Ÿã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆã‚’ä½¿ã£ãŸã€Œæ˜ŸÃ—æ‰èƒ½ã€ã®çµæœãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>";
        return;
      }

      const zodiac = getZodiacFromBirthdate(dateStr);
      if (!zodiac) {
        astroResultBox.innerHTML = "<p>ç”Ÿå¹´æœˆæ—¥ã‚’æ­£ã—ãå…¥åŠ›ã§ãã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ã¿ã¦ãã ã•ã„ã€‚</p>";
        return;
      }

      const typeKey = `${latestTalentElementKey}-${zodiac.element}`;
      const typeData = talentStarTypes[typeKey];

      if (!typeData) {
        astroResultBox.innerHTML = "<p>æ˜Ÿã¨æ‰èƒ½ã®çµ„ã¿åˆã‚ã›çµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>";
        return;
      }

      const talentName = elementDisplayNames[latestTalentElementKey] || latestTalentElementKey;
      const starElementLabel = starElementLabels[zodiac.element] || "";

      let html = "";
      html += `<p class="small">
        å¤ªé™½æ˜Ÿåº§ï¼š<strong>${zodiac.name}</strong><br>
        æ˜Ÿã®ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆï¼š<strong>${starElementLabel}</strong><br>
        æ‰èƒ½ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆï¼ˆè¨ºæ–­çµæœï¼‰ï¼š<strong>${talentName}</strong>
      </p>`;
      html += `<p class="small">ğŸŒ™ 12æ˜Ÿåº§ã‹ã‚‰è¦‹ã‚‹ãƒ†ãƒ¼ãƒï¼š${zodiac.description}</p>`;
      html += `<p><strong>æ˜Ÿã¨æ‰èƒ½ã‚’åˆã‚ã›ãŸã‚¿ã‚¤ãƒ—ï¼š${typeData.title}</strong><br>
        <span class="small">${typeData.oneLine}</span></p>`;
      if (typeData.longText) {
        html += `<p class="small">${typeData.longText.replace(/\n/g, "<br>")}</p>`;
      }

      astroResultBox.innerHTML = html;
    }

    birthDateInput.addEventListener("change", () => {
      if (latestTalentElementKey) {
        updateAstroResult();
      }
    });
  </script>

</body>
</html>
